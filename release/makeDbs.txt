USE master
IF DB_ID('QUANLYCUAHANGXEMAY') IS NOT NULL
DROP DATABASE QUANLYCUAHANGXEMAY

CREATE DATABASE QUANLYCUAHANGXEMAY
GO

USE QUANLYCUAHANGXEMAY

CREATE TABLE HÃNGXE (
	MÃHÃNG INT NOT NULL IDENTITY(1,1) ,
	TÊNHÃNG NVARCHAR(30) NULL,
	QUỐCGIA NVARCHAR(30) NULL,
	NĂMTHÀNHLẬP INT NULL,
	CONSTRAINT PK_HÃNGXE PRIMARY KEY(MÃHÃNG) 
)


CREATE TABLE DÒNGXE (
	MÃLOẠI INT NOT NULL IDENTITY(1,1),
	TÊNLOẠI NVARCHAR(30) NULL,
	HÃNGXE INT NOT NULL,
	GIÁNHẬP INT NULL,
	GIÁBÁN INT NULL,
	CONSTRAINT PK_DÒNGXE PRIMARY KEY(MÃLOẠI)
)

CREATE TABLE XE(
	MÃXE INT NOT NULL IDENTITY(1,1) ,
	MÃLOẠI INT NOT NULL,
	CÒNTRONGKHO BIT NULL,
	CONSTRAINT PK_XE PRIMARY KEY(MÃXE)
)

CREATE TABLE ĐƠNHÀNG(
	MÃĐƠNHÀNG INT NOT NULL IDENTITY(1,1),
	NGÀYĐẶTHÀNG DATE NULL
	CONSTRAINT PK_ĐƠNHÀNG PRIMARY KEY(MÃĐƠNHÀNG)
)

CREATE TABLE CT_ĐƠNHÀNG(
	MÃĐƠNHÀNG INT NOT NULL,
	MÃLOẠI INT NOT NULL,
	SỐLƯỢNG INT
	CONSTRAINT PK_CT_ĐƠNHÀNG PRIMARY KEY(MÃĐƠNHÀNG, MÃLOẠI)
)

ALTER TABLE DÒNGXE ADD CONSTRAINT FK_DÒNGXE_HÃNGXE
FOREIGN KEY(HÃNGXE)
REFERENCES HÃNGXE(MÃHÃNG)

ALTER TABLE XE ADD CONSTRAINT FK_XE_DÒNGXE
FOREIGN KEY(MÃLOẠI)
REFERENCES DÒNGXE(MÃLOẠI)